# hse24_hw5
---
### Выполнила Михайлова Ирина Александровна, группа 2.

Выполняла задание локально в *[google colab](https://colab.research.google.com/drive/1vd1NVKl15iC2qofzTW1gTg6TR203Ud1p?usp=sharing)*.
---
Мы анализируем данные scRNA-seq из статьи *"Single-cell mapping of the thymic stroma identifies IL-25-producing tuft epithelial cells"*. 

### Нормализация.

***scRNA-seq*** — это метод, позволяющий исследовать экспрессию генов на уровне отдельных клеток, изучать гетерогенность клеток в образце, выявляя различия в экспрессии генов между отдельными клетками, понять функциональные различия и специфические роли различных клеток.

Анализируя первичные необработанные данные scRNA-seq необходимо учитывать, что различия в экспрессии могут быть обусловлены не только дифференциальной экспрессией генов, но и общим уровнем экспрессии клетками. В отдельных клетках процесс экспрессии в целом может проходить более или менее интенсивно по тем или иным причинам, при этом соотношение экспрессируемых генов не изменяется. Чтобы компенсировать этот эффект, используется нормализация данных с помощью метода ***RPM** - reads per million*, при котором число чтений для каждого гена делится на общее число чтений в образце и умножается на миллион.

Кроме того, важно учитывать, что при одинаковом уровне экспрессии длинные гены получают больше чтений, чем короткие. Для компенсации этого эффекта применяется метод ***RPK** - reads per kilobase*, где число чтений для гена делится на его длину и умножается на тысячу.

Идеальным вариантом нормализации являются методы ***TPM** - transcripts per million* и ***RPKM** - reads per kilobase per million*, которые объединяют нормализацию по общему уровню экспрессии и нормализацию по длине гена. Однако в нашей работе применение ***RPK***, а значит и ***TPM*** и ***RPKM***, невозможно, так как у нас отсутствуют данные о длинах генов. Поэтому мы используем метод ***RPM*** для нормализации данных. Это позволит нам корректно интерпретировать результаты анализа и минимизировать влияние различий в общем уровне экспрессии клеток.

#### ***Heatmap*** для экспрессии маркерных генов.

![download](https://github.com/user-attachments/assets/1a48bc87-d788-4d54-841b-90e7f3afe1af)

#### Полученные визуализации ***UMAP*** и ***PCA***.

![3](https://github.com/user-attachments/assets/468ea5ae-baaf-4349-898e-e7db997a0277)

![4](https://github.com/user-attachments/assets/6c461032-36da-459d-8489-dacf5e9ee961)

#### Выводы:
* На получившихся графиках видны группы клеток с разной экспрессией генов что говорит об их функциональных различиях.
* ***PCA*** хуже выделяет кластеры, чем ***UMAP***. ***PCA*** лучше всего отделяет кластер *mTEC-I*, *UMAP - MTEC-IV*.
---
### Бонус.

Сравним уровни экспресси подгруппы клеток *mTEC-IV* из прошлой части с *bulk RNA-seq* для целого тимуса мыши из статьи *[Meredith et al, 2015](https://pubmed.ncbi.nlm.nih.gov/26237550/)*.

Часть *DESeq2* в *R* выполнила в отдельном *[google colab](https://colab.research.google.com/drive/1-vQO9-eyP_wl_fvaesMm3ScetpsSnpqH?usp=sharing)*

#### Маркерные гены из основной части задания.

![5](https://github.com/user-attachments/assets/a11b2afb-39f3-4912-91dc-c04b16325e32)

#### 100 наиболее высоко-экспрессированных генов как в ***bulk***, так и ***scRNA***.

![6](https://github.com/user-attachments/assets/981dfefc-22c8-4377-859d-2ab7651e3e4c)

#### Вывод:
* Много генов близки по экспресии, но значительная часть всё же отличается. Это значит, что экспрессия клеток образцов *bulk* и *single cell RNA-seq* различаются.

#### Результаты DESeq2.

![download](https://github.com/user-attachments/assets/1d09110b-1375-4ee6-99a8-827927961bf9)

